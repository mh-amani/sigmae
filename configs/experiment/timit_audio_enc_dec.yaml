# @package _global_

defaults:
  - example
  - override /data: audio
  - override /data/dataset: audio/timit
  - override /model: t5_speech_text

trainer:
  min_epochs: 50
  max_epochs: 100
  accumulate_grad_batches: 8
  

data:
#how much data has x and z; how much of data I'll use for zxz
  append_speaker_id: True
  supervision_ratio: [0.0, 1.0]
  batch_size: 1
  max_audio_length: ${model.model_params.max_z_length}
  speaker_id_column_name: "speaker_id"

callbacks:
  supervision_scheduler:
      scheduler_xz: 
        hp_init: 0.0
        hp_end: 0.0
      scheduler_z:
        hp_init: 1.0
        hp_end: 1.0

  early_stopping:
    monitor: "val/loss"
    patience: 3
    mode: "min"
  model_checkpoint:
    monitor: "val/zxz/tf/loss"
    mode: "min"

model:
  optimizer:
    lr: 0.0001
    
  model_params:
    monitor: 'val/zxz/tf/loss'
    # to be manually set
    teacher_force_prob: 0.5
    x_vocab_size: 81
    z_vocab_size: 81
    max_x_length: 100
    max_z_length: 200
    num_mel_bins: 80
    speaker_embedding_dim: 512
    # image_size: 28
    d_model: 768
    # processor:
    #   image_mean: 0.5
    #   image_std: 0.5
    #   image_size: 28
  
